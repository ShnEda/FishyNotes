# SSTI (Server-Side Template Injection)

## Template Engine Nedir?

Template engine'ler ekrana dinamik içerik bastırmak için kullanılan araçlardır. Veritabanından gelen verileri HTML sayfalarına entegre etmek gibi. Ancak bu özellikler amacı dışında da kullanılabilir ve güvenlik açığına dönüşebilir.

**Yaygın Template Engine'ler:** Jinja2 (Python), Twig (PHP), Thymeleaf (Java), Freemarker, Velocity

## SSTI Nedir?

Server-Side Template Injection, kullanıcıdan alınan girdinin template engine tarafından kod olarak işlenmesi sonucu ortaya çıkan zafiyettir.

## SSTI Nelere Sebep Olabilir?

- Dosya okuma
- Uzaktan kod çalıştırma (RCE)
- Sistemde yetkisiz işlem yapma

## SSTI Tespiti

Sistemde SSTI olup olmadığını görmek için bazı random payload'lar atabiliyoruz ve orada var mı yok mu öğrenebiliyoruz.

**Test Payload Örnekleri:**
```
{{7*7}}
${7*7}
<%= 7*7 %>
${{7*7}}
#{7*7}
```

Eğer sonuç `49` dönüyorsa SSTI zafiyeti mevcut demektir.

## SSTI Nasıl Önlenir?

Kullanıcıyla template engine arasına güvenlik katmanı koymamız gerekir ve kullanıcının doğrudan kod göndermemesi lazım.

**Korunma Yöntemleri:**
- Kullanıcı girdilerini template'e direkt vermemek
- Input validation ve sanitization
- Sandboxing kullanmak
- Template logic ile user input'u ayırmak

> **SSTIMap:** SSTI zafiyetlerini tespit etmek ve exploit etmek için kullanılan araç. Ancak çok stabil çalışmıyor.
