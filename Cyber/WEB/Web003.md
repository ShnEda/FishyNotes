# XSS (Cross-Site Scripting)

Kritik kelime JavaScript. Genellikle en yüksek seviye stored XSS bulduğunda admin cookie'sini ele geçirmek amaçlanır. Kullanıcının oturum bilgilerini çalmak, başka siteye yönlendirmek, web sitesini kullanılamaz hale getirmek, bazı amaçlarındandır.

## XSS Türleri

### Reflected XSS
Tek seferlik gerçekleşir. Kullanıcıdan alınan girdinin içerisinde JS kodu bulunması ve bu kodun ekrana doğrudan bastırılması sonucu ortaya çıkan XSS türüdür. Attığımız JS kodu çalışıyor ama bu kod sadece kurbanın browserında gözüküyor, sunucuda kalıcı olmuyor. Bu zafiyet genellikle düşük öncelikli görülür çünkü kullanılabilitesi zor, phishing veya bir senaryo üzerinde çalıştırmak gerek. Ama hedeflenmiş reflected XSS (mesela admin'e özel link) ciddi risk oluşturabilir.

### Stored XSS
Reflected XSS ile benzemektedir ancak farkı kullanıcıdan alınan girdinin veritabanı üzerinde kaydedilmesi sonucu sayfa her ziyaret edildiğinde kodun çalışmasıdır. Attığımız payload veritabanına kaydoluyor, herhangi bir kullanıcı geldiğinde yazılan script otomatik çalışıyor mesela `alert(1)` bastırabiliyoruz. Kim girerse girsin aynı sonucu elde ettirir. En tehlikeli tür budur. Basit sitelerde XSS olmaması için blacklist yapılır tırnak işareti vb engellenir ama sadece blacklist yetersiz, context-aware escaping veya whitelist tercih edilmeli.

### DOM Based XSS
DOM tabanlı XSS, bir web sayfasında değişiklik DOM'da meydana gelen XSS zafiyetidir. Genellikle URL üzerinde gerçekleşir. Akıl karıştırıcı bir özellik gibi gözükse de mantığı JS ile farklı etiketlerin değiştirilmesiyle alakalı.

**DOM (Document Object Model) Nedir?**
Biz HTML yapısını bir şema gibi düşünebiliriz. Document Object Model, her bir HTML elementinin JS gözünde bir obje olarak temsil edilmesidir. Kullanım amacı özelliklerin interaktif şekilde JS ile değiştirilmesidir.

**JS ile DOM Manipülasyonu:**
Amaç genelde `document.getElementById("baslik")` gibi bir elementi seçip, bunun stil niteliğinin rengini kırmızı yapmak gibi işlemlerdir. Bu başlık özelliğini bulacak, bunun rengini değiştirecek. En basit örneği DOM'un bu şekilde çalışmasıdır.

**Farkı Nedir?**
Normalde sağ tık yapıp kodu gör dediğimiz zaman XSS normal bir satırda gözükür (reflected/stored ise). Buradaysa kaynak tamamen client-side (`location.hash`, `referrer`, `localStorage` gibi) olup JS tarafından DOM'a yazılıyor ve çalışıyor. Sunucu cevabında görünmez.
